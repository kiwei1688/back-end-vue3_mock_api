/* empty css             */import{E as T,a as U,v as z,b as M,u as O}from"./el-form-item-a0e05ecb.js";import{E as R}from"./el-button-63d66e8e.js";import"./el-scrollbar-1e581fab.js";import{d as W,a2 as A,r as d,a6 as D,a1 as L,R as P,o as q,D as J,a as h,c as $,h as m,l as c,E as s,w as l,O as j,a0 as G,_ as v,a7 as H,bc as k,j as K}from"./index-984efd80.js";/* empty css                   */import{b}from"./index-d171433e.js";import"./plugin-vue_export-helper-1cff8a04.js";import"./index-c7325122.js";import"./typescript-defaf979.js";const Q={class:"login"},X={class:"form-container"},Y={class:"manage-tip"},Z={class:"title"},x={class:"tiparea"},pe=W({__name:"login",setup(ee){const{locale:y,t:i}=A(),V=d(["zh-TW","zh-CN","zh-EN"]),u=d({lang:"zh-TW"}),w=d(),S=D(),g=L(),n=d({username:"roy6874ya@yahoo.com.tw",password:"shit0704",email:"roy6874ya@yahoo.com.tw"}),I=P({email:[{type:"email",required:!0,message:i("mailErr"),trigger:"blur"}],password:[{required:!0,message:i("PWisEmpty"),trigger:"blur"},{min:6,max:30,message:i("sixTothirty"),trigger:"blur"}]}),N=()=>{y.value=u.value.lang},C=e=>{localStorage.setItem("lang",u.value.lang),e&&e.validate(async a=>{if(a){const p="https://vue3-course-api.hexschool.io/admin/signin";try{const{data:{success:o,token:r,message:_,uid:E}}=await H.post(p,n.value),f=JSON.parse(localStorage.getItem("memberInfo")||"{}");o&&r?(localStorage.setItem("memberInfo",JSON.stringify({...f,token:r})),g.setToken(r),g.setAuth(!!k(r)),g.setUser(k(r)),b({message:i("loginSuccess"),type:"success"}),S.push({path:"/"})):b({type:"error",message:_})}catch(o){console.error("err",o),console.error("err.response.data.msg",o.response.data.msg),b({message:o.response.data.msg,type:"error"})}}else return console.log("err submit"),!1})};return q(()=>{y.value=u.value.lang}),(e,a)=>{const p=T,o=U,r=O,_=z,E=R,f=J("router-link"),F=M;return h(),$("div",Q,[m("section",X,[m("div",Y,[m("span",Z,c(e.$t("sysName")),1),s(F,{rules:I,ref_key:"ruleFormRef",ref:w,model:n.value,class:"loginForm","label-width":"80px"},{default:l(()=>[s(o,{label:e.$t("mail"),prop:"username"},{default:l(()=>[s(p,{modelValue:n.value.username,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.username=t),placeholder:e.$t("keyMail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:e.$t("password"),prop:"password"},{default:l(()=>[s(p,{modelValue:n.value.password,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.password=t),placeholder:e.$t("keyPW"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(o,{label:e.$t("lang")},{default:l(()=>[s(_,{modelValue:u.value.lang,"onUpdate:modelValue":a[2]||(a[2]=t=>u.value.lang=t),onChange:N},{default:l(()=>[(h(!0),$(j,null,G(V.value,(t,B)=>(h(),K(r,{key:B,label:e.$t(`language.${t}`),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(o,null,{default:l(()=>[s(E,{onClick:a[3]||(a[3]=t=>C(w.value)),class:"submit-btn"},{default:l(()=>[v(c(e.$t("login")),1)]),_:1})]),_:1}),m("div",x,[m("p",null,[v(c(e.$t("noAcc")),1),s(f,{to:"/register"},{default:l(()=>[v(c(e.$t("register")),1)]),_:1})])])]),_:1},8,["rules","model"])])])])}}});export{pe as default};
