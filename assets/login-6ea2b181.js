/* empty css             */import{E as B,a as T,v as z,b as M,u as W}from"./el-form-item-d267b09f.js";import{E as A}from"./el-button-f5a41626.js";import"./el-scrollbar-590813ff.js";import{d as L,ae as O,r as d,aj as P,ad as R,$ as j,o as q,H as D,a as v,c as w,j as m,m as c,I as o,w as t,U as J,ac as H,aa as h,ak as G,bv as E,ah as b,k as K}from"./index-032c6402.js";/* empty css                   */const Q={class:"login"},X={class:"form-container"},Y={class:"manage-tip"},Z={class:"title"},x={class:"tiparea"},ne=L({__name:"login",setup(ee){const{locale:y,t:i}=O(),V=d(["zh-TW","zh-CN","zh-EN"]),u=d({lang:"zh-TW"}),k=d(),S=P(),g=R(),n=d({username:"roy6874ya@yahoo.com.tw",password:"shit0704",email:"roy6874ya@yahoo.com.tw"}),I=j({email:[{type:"email",required:!0,message:i("mailErr"),trigger:"blur"}],password:[{required:!0,message:i("PWisEmpty"),trigger:"blur"},{min:6,max:30,message:i("sixTothirty"),trigger:"blur"}]}),N=()=>{y.value=u.value.lang},C=e=>{localStorage.setItem("lang",u.value.lang),e&&e.validate(async a=>{if(a){const p="https://vue3-course-api.hexschool.io/admin/signin";try{const{data:{success:s,token:r,message:_,uid:$}}=await G.post(p,n.value),f=JSON.parse(localStorage.getItem("memberInfo")||"{}");s&&r?(localStorage.setItem("memberInfo",JSON.stringify({...f,token:r})),g.setToken(r),g.setAuth(!!E(r)),g.setUser(E(r)),b({message:i("loginSuccess"),type:"success"}),S.push({path:"/"})):b({type:"error",message:_})}catch(s){console.error("err",s),console.error("err.response.data.msg",s.response.data.msg),b({message:s.response.data.msg,type:"error"})}}else return console.log("err submit"),!1})};return q(()=>{y.value=u.value.lang}),(e,a)=>{const p=B,s=T,r=W,_=z,$=A,f=D("router-link"),F=M;return v(),w("div",Q,[m("section",X,[m("div",Y,[m("span",Z,c(e.$t("sysName")),1),o(F,{rules:I,ref_key:"ruleFormRef",ref:k,model:n.value,class:"loginForm","label-width":"80px"},{default:t(()=>[o(s,{label:e.$t("mail"),prop:"username"},{default:t(()=>[o(p,{modelValue:n.value.username,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value.username=l),placeholder:e.$t("keyMail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(s,{label:e.$t("password"),prop:"password"},{default:t(()=>[o(p,{modelValue:n.value.password,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value.password=l),placeholder:e.$t("keyPW"),type:"password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(s,{label:e.$t("lang")},{default:t(()=>[o(_,{modelValue:u.value.lang,"onUpdate:modelValue":a[2]||(a[2]=l=>u.value.lang=l),onChange:N},{default:t(()=>[(v(!0),w(J,null,H(V.value,(l,U)=>(v(),K(r,{key:U,label:e.$t(`language.${l}`),value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),o(s,null,{default:t(()=>[o($,{onClick:a[3]||(a[3]=l=>C(k.value)),class:"submit-btn"},{default:t(()=>[h(c(e.$t("login")),1)]),_:1})]),_:1}),m("div",x,[m("p",null,[h(c(e.$t("noAcc")),1),o(f,{to:"/register"},{default:t(()=>[h(c(e.$t("register")),1)]),_:1})])])]),_:1},8,["rules","model"])])])])}}});export{ne as default};
